---
title: "MAS432-final"
author: "Jingyi Zhao"
date: "5/10/2022"
output: html_document
---
Using the data set kc_house_data.csv, build a model to predict housing cost. 

```{r}
df=read.csv("kc_house_data.csv")
summary(df)
```
```{r results= "hide"}
library(leaps)
BSR = regsubsets(price~bedrooms+bathrooms+sqft_living+sqft_lot+floors+waterfront+view+condition+grade+sqft_above+sqft_basement+yr_built+yr_renovated+zipcode+lat+long+sqft_living15+sqft_lot15, data =df)
plot(BSR)
plot(BSR, scale = "adjr2")
```
Which variables are in the best subset?
*bedrooms, sqft_living, waterfront, view, grade,yr_renovated, lat, long, sqft_living15*

Use R to the find the number of variables in best subsets.
```{r}
s= summary(BSR)
#s$adjr2
which.max(s$adjr2)
```
Get a summary of the best subsets result.
```{r}
reg=lm(price~bedrooms+sqft_living+ waterfront+view+grade+yr_renovated+lat+long+sqft_living15,data=df)
summary(reg)
```
```{r}
df1= subset(df, select=c('bedrooms', 'sqft_living', 'waterfront', 'view', 'grade','yr_renovated', 'lat', 'long', 'sqft_living15'))
```
Find a correlation plot between the variables within the data subset(bedrooms, sqft_living, waterfront, view, grade,yr_renovated, lat, long, sqft_living15)
```{r}
library(corrplot)          
M<-cor(df1)
c=cor(M)
corrplot(M)
```
Generate a scatterplot matrix from the variables within the data subset
```{r}
plot(df1)
```


```{r}
barplot(df$bedrooms, xlab = "bedrooms", ylab = "Frequency",
main = "Barplot of symboling Frequencies")
barplot(df$sqft_living, xlab = "sqft_living", ylab = "Frequency",
main = "Barplot of symboling Frequencies")
barplot(df$waterfront, xlab = "waterfront", ylab = "Frequency",
main = "Barplot of symboling Frequencies")
barplot(df$view, xlab = "view", ylab = "Frequency",
main = "Barplot of symboling Frequencies")
barplot(df$grade, xlab = "grade", ylab = "Frequency",
main = "Barplot of symboling Frequencies")
barplot(df$yr_renovated, xlab = "yr_renovated", ylab = "Frequency",
main = "Barplot of symboling Frequencies")
barplot(df$lat, xlab = "lat", ylab = "Frequency",
main = "Barplot of symboling Frequencies")
barplot(df$long, xlab = "long", ylab = "Frequency",
main = "Barplot of symboling Frequencies")
barplot(df$sqft_living15, xlab = "sqft_living15", ylab = "Frequency",
main = "Barplot of symboling Frequencies")
```
bedrooms', 'sqft_living', 'waterfront', 'view', 'grade','yr_renovated', 'lat', 'long', 'sqft_living15'
## Construct a scatterplot and histogram of the residuals for the Full model
```{r}
plot(reg,which=1)
hist(reg$residuals, xlab = "Residuals")
```
## BoxCox (Response variable transformation)
```{r}
library(car)
boxCox(reg)
regnew = lm(log(price)~bedrooms+sqft_living+ waterfront+view+grade+yr_renovated+lat+long+sqft_living15,data=df)
summary(regnew)
```